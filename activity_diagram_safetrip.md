# Activity Diagram - Đặt vé và thanh toán trực tiếp SAFETRIP

## Mô tả luồng hoạt động

```
┌─────────────────────┬─────────────────────┬─────────────────────┐
│    Khách hàng       │      Hệ thống       │    Nhân viên        │
├─────────────────────┼─────────────────────┼─────────────────────┤
│                     │                     │                     │
│  ●                  │                     │                     │
│  │                  │                     │                     │
│  ▼                  │                     │                     │
│ [Truy cập hệ thống] │                     │                     │
│  │                  │                     │                     │
│  ▼                  │                     │                     │
│ [Nhập thông tin     │                     │                     │
│  chuyến đi]         │                     │                     │
│  │                  │                     │                     │
│  ▼                  │                     │                     │
│  ◇ Loại vé?         │                     │                     │
│  ├─[Khứ hồi]────────────────────┐        │                     │
│  │                  │           │        │                     │
│  │ [Nhập ngày đi,   │           │        │                     │
│  │  ngày về,        │           │        │                     │
│  │  số lượng]       │           │        │                     │
│  │                  │           │        │                     │
│  └─[Một chiều]──────────────────┤        │                     │
│     │               │           │        │                     │
│     │ [Nhập ngày đi,│           │        │                     │
│     │  số lượng]    │           │        │                     │
│     │               │           ▼        │                     │
│     └───────────────┼──────────►│        │                     │
│                     │           │        │                     │
│                     │  [Hiển thị danh    │                     │
│                     │   sách giờ khởi    │                     │
│                     │   hành và giá]     │                     │
│                     │           │        │                     │
│     ◄───────────────┼───────────┘        │                     │
│     │               │                     │                     │
│  [Chọn thời điểm]   │                     │                     │
│     │               │                     │                     │
│     └──────────────►│                     │                     │
│                     │ [Tính tổng tiền]   │                     │
│     ◄───────────────┤                     │                     │
│     │               │                     │                     │
│  [Xác nhận đặt vé]  │                     │                     │
│     │               │                     │                     │
│     ▼               │                     │                     │
│     ◇ Có tài khoản? │                     │                     │
│     ├─[Có]──────────┐                    │                     │
│     │               │                    │                     │
│     │ [Đăng nhập]   │                    │                     │
│     │               │                    │                     │
│     └─[Không]───────┤                    │                     │
│         │           │                    │                     │
│    [Nhập thông tin  │                    │                     │
│     cá nhân:        │                    │                     │
│     - Họ tên        │                    │                     │
│     - Giới tính     │                    │                     │
│     - Năm sinh      │                    │                     │
│     - CMND          │                    │                     │
│     - Email         │                    │                     │
│     - SĐT           │                    │                     │
│     - Địa chỉ]      │                    │                     │
│         │           ▼                    │                     │
│         └───────────┼────────────────────►│                     │
│                     │                     │                     │
│  [Chọn nơi giao vé] │                     │                     │
│     │               │                     │                     │
│     ▼               │                     │                     │
│     ◇ Địa điểm giao?│                     │                     │
│     ├─[Chi nhánh]───────────┐            │                     │
│     │               │        │            │                     │
│     │ [Chọn chi     │        │            │                     │
│     │  nhánh]       │        │            │                     │
│     │               │        │            │                     │
│     └─[Địa chỉ khác]────────┤            │                     │
│         │           │        │            │                     │
│    [Nhập địa chỉ    │        │            │                     │
│     chi tiết]       │        │            │                     │
│         │           │        ▼            │                     │
│         └───────────┼────────►│           │                     │
│                     │         │           │                     │
│                     │  [Tính phí giao vé] │                     │
│                     │  - 0đ nếu chi nhánh │                     │
│                     │  - Tính theo km     │                     │
│                     │    nếu địa chỉ khác│                     │
│                     │         │           │                     │
│                     │  [Hiển thị tổng    │                     │
│                     │   chi phí]          │                     │
│     ◄───────────────┼─────────┘           │                     │
│     │               │                     │                     │
│  [Xác nhận đặt vé   │                     │                     │
│   và thanh toán sau]│                     │                     │
│     │               │                     │                     │
│     └──────────────►│                     │                     │
│                     │ [Tạo mã giao dịch] │                     │
│                     │         │           │                     │
│                     │ [Gửi email xác     │                     │
│                     │  nhận với link]     │                     │
│     ◄───────────────┤         │           │                     │
│     │               │         │           │                     │
│  [Click link        │         │           │                     │
│   xác nhận]         │         │           │                     │
│     │               │         │           │                     │
│     └──────────────►│         │           │                     │
│                     │ [Lưu xác nhận]     │                     │
│                     │         │           │                     │
│                     │         └───────────┼─────────────────────►
│                     │                     │                     │
│                     │                     │ [Giao vé cho        │
│                     │                     │  khách hàng]        │
│                     │                     │         │           │
│                     │                     │         ▼           │
│                     │                     │ [Thu tiền từ        │
│                     │                     │  khách hàng]        │
│                     │                     │         │           │
│                     │         ◄───────────┼─────────┘           │
│                     │         │           │                     │
│                     │ [Cập nhật trạng    │                     │
│                     │  thái: Đã thanh    │                     │
│                     │  toán]              │                     │
│                     │         │           │                     │
│                     │         ○           │                     │
│                     │                     │                     │
└─────────────────────┴─────────────────────┴─────────────────────┘
```

## Giải thích các ký hiệu:
- ● : Điểm bắt đầu
- ○ : Điểm kết thúc
- ◇ : Điểm quyết định
- [ ] : Hoạt động
- → : Luồng hoạt động
- ▼ : Luồng đi xuống
</rewritten_file> 